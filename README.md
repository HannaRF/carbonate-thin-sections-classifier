Aqui estÃ¡ um **README completo**, integrado com o conteÃºdo da Trilha 2, organizado e fluido, seguindo a estrutura que vocÃª comeÃ§ou:

---

# ğŸª¨ Track 2: Petrographic Thin Sections

### HACKATHON AI FOR OIL & GAS

#### Team: Rock the Net

**Members:**

* Matheus do Ã“
* JoÃ£o Nogueira
* Juan David Nieto
* Hanna Rodrigues

---

# 1. Introduction

## The Challenge

This challenge focuses on **classifying lithologies in petrographic thin-section images** of **synthetic carbonate rocks** generated by a GAN trained on real Petrobras data.
The model receives a **thin-section image** and predicts one of four carbonate lithology classes:

* **ESF â€” Esferulitito (Spherulitic)**
* **ETR â€” EstromatÃ³lito (Stromatolitic)**
* **RET â€” Retrabalhado (Reworked)**
* **LMT â€” Laminito (Laminated)**

---

# 2. Dataset Description

### Training Set

* 1,100 synthetic carbonate thin-section images
* 256Ã—256 px
* Labels encoded in filenames

### Test Set

* 446 unlabeled images
* 512Ã—512 px

---

# 3. Challenges

We identified three major obstacles in Trilha 2:

1. **Noise and inconsistent data quality**
2. **Strong class imbalance**
3. **Artifacts introduced by synthetic GAN generation**

---

# 4. Methodology

Our solution was based on a **two-phase Transfer Learning pipeline with ResNeXt-50**, combined with class-balancing techniques and strong data augmentation.

## Preprocessing & Data Augmentation

* Image resizing and normalization
* Robust augmentations to increase generalization
* **Random Erasing** to simulate real petrographic variability
* **Oversampling** minority classes
* **Dropout1d** to improve regularization

## Model Architecture

* Backbone: **ResNeXt-50**
* Classifier fully fine-tuned

## Training

* **Phase 1 â€” Training:** 50 epochs
* **Phase 2 â€” Fine-tuning:** 100 epochs with reduced LR and more layers unfrozen

## Loss Function

* **Weighted Cross-Entropy**, with class weights adjusted to reduce bias toward dominant classes

---

# 5. Results

### F1-Scores

| Class             | Training  | Validation |
| ----------------- | --------- | ---------- |
| ESF               | 0.995     | 0.682      |
| ETR               | 0.996     | 0.863      |
| LMT               | 1.000     | 0.700      |
| RET               | 0.996     | 0.908      |
| **Macro Average** | **0.997** | **0.788**  |

The strategy achieved strong generalization despite the imbalance and synthetic noise.

### Example â€” Random Erasing Augmentation

(Images omitted here, but this is where they would appear in the repo)

---

# 6. Bonus Exploration

We experimented with **Stable Diffusion + Inpainting** using the prompt:

> â€œcarbonate rock, petrographic slide, geological texture, high resolution, realistic, Stromatolite, Spherulite, Laminite, Reworkedâ€

This served as a complementary approach for data enrichment and quality inspection.
