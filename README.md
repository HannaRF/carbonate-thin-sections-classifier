# ðŸª¨ Track 2: Petrographic Thin Sections

### HACKATHON : AI FOR OIL & GAS

#### Team: **Rock the Net**

**Members:**

* Matheus do Ã“
* JoÃ£o Nogueira
* Juan David Nieto
* Hanna Rodrigues

---

# The Challenge

This challenge focuses on **classifying lithologies in petrographic thin-section images** of synthetic carbonate rocks generated by a GAN trained on real Petrobras data.

The model receives a thin-section image and predicts one of four carbonate lithology classes:

* **ESF** : Esferulitito (Spherulitic)
* **ETR** : EstromatÃ³lito (Stromatolitic)
* **RET** : Retrabalhado (Reworked)
* **LMT** : Laminito (Laminated)

---

# Dataset Description

### **Training Set**

* 1,100 synthetic thin-section images
* 256 Ã— 256 px
* Labels embedded in filenames

### **Test Set**

* 446 unlabeled images
* 512 Ã— 512 px

<img src="images/Rock the Net.png" width="500">

---

# Challenges

We identified three core difficulties:

1. Noise and variability in data quality
2. Severe class imbalance
3. Presence of visual artifacts

<img src="images/Rock the Net (1).png" width="450">

---

# Methodology

Our approach was built around a **two-stage Transfer Learning pipeline** using **ResNeXt-50**, supported by targeted data balancing and strong augmentation strategies.

## **Preprocessing & Data Augmentation**

* Image resizing and normalization
* Extensive augmentation for robustness
* **Random Erasing** to emulate petrographic uncertainty
* **Oversampling** minority classes
* **Dropout1d** for additional regularization

## **Model Architecture**

* Backbone: **ResNeXt-50**
* Fully fine-tuned classification head

## **Training Strategy**

* **Stage 1:** 50 training epochs
* **Stage 2:** 100 fine-tuning epochs with reduced learning rate and more unfrozen layers

## **Loss Function**

* **Weighted Cross-Entropy**, with class weights designed to mitigate imbalance and prevent bias toward overrepresented lithologies

## **Inference**

For inference, test images are divided into overlapping patches (50% overlap). Each patch is classified independently, and the final prediction is obtained by assigning the most frequent predicted class across all patches.

---

# Results

<img src="images/Rock the Net (2).png" width="650">
<img src="images/Rock the Net (4).png" width="650">
<img src="images/Rock the Net (3).png" width="400">

Our strategy achieved **strong generalization performance**, even in the presence of noise, synthetic textures, and uneven class distribution.

---

# Bonus Exploration

We also explored **Stable Diffusion + Inpainting** for data enrichment and qualitative inspection.
Prompt used:

> *"carbonate rock, petrographic slide, geological texture, high resolution, realistic, Stromatolite, Spherulite, Laminite, Reworked"*

<img src="images/Rock the Net (5).png" width="500">
